<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.yibo.modules.base.dao.RoleDao">
    <!-- 在这里存放用户自定义的映射配置（注：RoleDAO.xml里各节点的ID不能在这里重复出现）  -->
    <select id="findByUserId" resultType="com.yibo.modules.base.entity.Role">
        select
            b.id,
            b.role_name,
            b.role_code,
            b.role_weight,
            b.role_type,
            b.user_type,
            b.is_sys,
            b.status,
            b.comments,
            b.tenant_id
        from sys_user_role a
        left join sys_role b on a.role_id = b.id and b.status = 1
        <where>
            and a.user_id = #{userId}
        </where>
    </select>

    <!-- 唯一性校验 -->
    <select id="count" resultType="java.lang.Integer">
        select count(1) from sys_role
        where 1 = 1
        <if test="condition.id != null and condition.id.length() > 0">
            and id not in(select #{condition.id})
        </if>
        and role_code = #{condition.roleCode,jdbcType=VARCHAR}
        and status = 1
    </select>
</mapper>